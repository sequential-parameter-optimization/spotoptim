
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="spotoptim - Sequential Parameter Optimization Toolbox in Python">
      
      
      
        <link rel="canonical" href="https://github.com/sequential-parameter-optimization/spotoptim/reference/spotoptim/sampling/mm/">
      
      
        <link rel="prev" href="../lhs/">
      
      
        <link rel="next" href="../../surrogate/kernels/">
      
      
        
      
      
      <link rel="icon" href="../../../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>mm - spotoptim</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#spotoptim.sampling.mm" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="spotoptim" class="md-header__button md-logo" aria-label="spotoptim" data-md-component="logo">
      
  <img src="../../../../images/spotlogo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            spotoptim
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              mm
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="grey" data-md-color-accent="orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/sequential-parameter-optimization/spotoptim/tree/main" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="spotoptim" class="md-nav__button md-logo" aria-label="spotoptim" data-md-component="logo">
      
  <img src="../../../../images/spotlogo.png" alt="logo">

    </a>
    spotoptim
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/sequential-parameter-optimization/spotoptim/tree/main" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Code Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Code Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    spotoptim
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    spotoptim
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../SpotOptim/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SpotOptim
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../core/data/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    core
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../data/base/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    data
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../eda/plots/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    eda
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../factor_analyzer/confirmatory_factor_analyzer/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    factor_analyzer
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../function/forr08a/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    function
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../hyperparameters/parameters/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    hyperparameters
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../inspection/importance/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    inspection
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../mo/mo_mm/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    mo
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../nn/linear_regressor/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    nn
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../optimizer/schedule_free/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    optimizer
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../plot/contour/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    plot
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_13" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1_13" id="__nav_2_1_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    sampling
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_13_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    sampling
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    design
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../effects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    effects
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lhs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    lhs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    mm
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    mm
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm" class="md-nav__link">
    <span class="md-ellipsis">
      
        mm
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.bestlh" class="md-nav__link">
    <span class="md-ellipsis">
      
        bestlh
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.jd" class="md-nav__link">
    <span class="md-ellipsis">
      
        jd
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.mm" class="md-nav__link">
    <span class="md-ellipsis">
      
        mm
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.mm_improvement" class="md-nav__link">
    <span class="md-ellipsis">
      
        mm_improvement
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.mm_improvement_contour" class="md-nav__link">
    <span class="md-ellipsis">
      
        mm_improvement_contour
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.mmlhs" class="md-nav__link">
    <span class="md-ellipsis">
      
        mmlhs
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.mmphi" class="md-nav__link">
    <span class="md-ellipsis">
      
        mmphi
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.mmphi_intensive" class="md-nav__link">
    <span class="md-ellipsis">
      
        mmphi_intensive
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.mmphi_intensive_update" class="md-nav__link">
    <span class="md-ellipsis">
      
        mmphi_intensive_update
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.mmsort" class="md-nav__link">
    <span class="md-ellipsis">
      
        mmsort
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.perturb" class="md-nav__link">
    <span class="md-ellipsis">
      
        perturb
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.phisort" class="md-nav__link">
    <span class="md-ellipsis">
      
        phisort
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.plot_mmphi_vs_n_lhs" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_mmphi_vs_n_lhs
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.plot_mmphi_vs_points" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_mmphi_vs_points
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.propose_mmphi_intensive_minimizing_point" class="md-nav__link">
    <span class="md-ellipsis">
      
        propose_mmphi_intensive_minimizing_point
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.subset" class="md-nav__link">
    <span class="md-ellipsis">
      
        subset
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../surrogate/kernels/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    surrogate
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../tricands/tricands/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    tricands
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../utils/boundaries/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    
  
    utils
  

    
  </span>
  
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../sequential-parameter-optimization-cookbook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Documentation
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../download/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Download
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm" class="md-nav__link">
    <span class="md-ellipsis">
      
        mm
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.bestlh" class="md-nav__link">
    <span class="md-ellipsis">
      
        bestlh
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.jd" class="md-nav__link">
    <span class="md-ellipsis">
      
        jd
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.mm" class="md-nav__link">
    <span class="md-ellipsis">
      
        mm
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.mm_improvement" class="md-nav__link">
    <span class="md-ellipsis">
      
        mm_improvement
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.mm_improvement_contour" class="md-nav__link">
    <span class="md-ellipsis">
      
        mm_improvement_contour
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.mmlhs" class="md-nav__link">
    <span class="md-ellipsis">
      
        mmlhs
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.mmphi" class="md-nav__link">
    <span class="md-ellipsis">
      
        mmphi
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.mmphi_intensive" class="md-nav__link">
    <span class="md-ellipsis">
      
        mmphi_intensive
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.mmphi_intensive_update" class="md-nav__link">
    <span class="md-ellipsis">
      
        mmphi_intensive_update
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.mmsort" class="md-nav__link">
    <span class="md-ellipsis">
      
        mmsort
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.perturb" class="md-nav__link">
    <span class="md-ellipsis">
      
        perturb
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.phisort" class="md-nav__link">
    <span class="md-ellipsis">
      
        phisort
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.plot_mmphi_vs_n_lhs" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_mmphi_vs_n_lhs
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.plot_mmphi_vs_points" class="md-nav__link">
    <span class="md-ellipsis">
      
        plot_mmphi_vs_points
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.propose_mmphi_intensive_minimizing_point" class="md-nav__link">
    <span class="md-ellipsis">
      
        propose_mmphi_intensive_minimizing_point
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spotoptim.sampling.mm.subset" class="md-nav__link">
    <span class="md-ellipsis">
      
        subset
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


  <nav class="md-path" aria-label="Navigation" >
    <ol class="md-path__list">
      
        
  
  
    <li class="md-path__item">
      <a href="../../../.." class="md-path__link">
        
  <span class="md-ellipsis">
    Home
  </span>

      </a>
    </li>
  

      
      
        
  
  
    
    
      
  
  
    
    
      <li class="md-path__item">
        <a href="../../SpotOptim/" class="md-path__link">
          
  <span class="md-ellipsis">
    Code Reference
  </span>

        </a>
      </li>
    
  

    
  

      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../../SpotOptim/" class="md-path__link">
          
  <span class="md-ellipsis">
    spotoptim
  </span>

        </a>
      </li>
    
  

      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../design/" class="md-path__link">
          
  <span class="md-ellipsis">
    sampling
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>mm</h1>

<div class="doc doc-object doc-module">



<a id="spotoptim.sampling.mm"></a>
    <div class="doc doc-contents first">










<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="spotoptim.sampling.mm.bestlh" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bestlh</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">population</span><span class="p">,</span> <span class="n">iterations</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">q_list</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span></code>

<a href="#spotoptim.sampling.mm.bestlh" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Generates an optimized Latin hypercube by evolving the Morris-Mitchell
criterion across multiple exponents (q values) and selecting the best plan.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of points required in the Latin hypercube.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>k</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of design variables (dimensions).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>population</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of offspring in each generation of the evolutionary search.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>iterations</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of generations for the evolutionary search.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The distance norm to use. p=1 for Manhattan (L1), p=2 for Euclidean (L2).
Defaults to 1 (faster than 2).</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>plot</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, a scatter plot of the optimized plan in the first two dimensions
will be displayed. Only if k&gt;=2. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbosity</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Verbosity level. 0 is silent, 1 prints the best q value found. Defaults to 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>edges</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If 1, places centers of the extreme bins at the domain edges ([0,1]).
Otherwise, bins are fully contained within the domain, i.e. midpoints.
Defaults to 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q_list</code>
            </td>
            <td>
                  <code><span title="list">list</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of q values to optimize. Defaults to [1, 2, 5, 10, 20, 50, 100].
These values are used to evaluate the space-fillingness of the Latin
hypercube. The best plan is selected based on the lowest mmphi value.</p>
              </div>
            </td>
            <td>
                  <code>[1, 2, 5, 10, 20, 50, 100]</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray:
A 2D array of shape (n, k) representing an optimized Latin hypercube.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotoptim.sampling.mm</span><span class="w"> </span><span class="kn">import</span> <span class="n">bestlh</span>
<span class="go"># Generate a 5-point, 2-dimensional Latin hypercube</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">bestlh</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">population</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(5, 2)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotoptim/sampling/mm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bestlh</span><span class="p">(</span>
    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">population</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">iterations</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">p</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">edges</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">q_list</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates an optimized Latin hypercube by evolving the Morris-Mitchell</span>
<span class="sd">    criterion across multiple exponents (q values) and selecting the best plan.</span>

<span class="sd">    Args:</span>
<span class="sd">        n (int):</span>
<span class="sd">            Number of points required in the Latin hypercube.</span>
<span class="sd">        k (int):</span>
<span class="sd">            Number of design variables (dimensions).</span>
<span class="sd">        population (int):</span>
<span class="sd">            Number of offspring in each generation of the evolutionary search.</span>
<span class="sd">        iterations (int):</span>
<span class="sd">            Number of generations for the evolutionary search.</span>
<span class="sd">        p (int, optional):</span>
<span class="sd">            The distance norm to use. p=1 for Manhattan (L1), p=2 for Euclidean (L2).</span>
<span class="sd">            Defaults to 1 (faster than 2).</span>
<span class="sd">        plot (bool, optional):</span>
<span class="sd">            If True, a scatter plot of the optimized plan in the first two dimensions</span>
<span class="sd">            will be displayed. Only if k&gt;=2. Defaults to False.</span>
<span class="sd">        verbosity (int, optional):</span>
<span class="sd">            Verbosity level. 0 is silent, 1 prints the best q value found. Defaults to 0.</span>
<span class="sd">        edges (int, optional):</span>
<span class="sd">            If 1, places centers of the extreme bins at the domain edges ([0,1]).</span>
<span class="sd">            Otherwise, bins are fully contained within the domain, i.e. midpoints.</span>
<span class="sd">            Defaults to 0.</span>
<span class="sd">        q_list (list, optional):</span>
<span class="sd">            A list of q values to optimize. Defaults to [1, 2, 5, 10, 20, 50, 100].</span>
<span class="sd">            These values are used to evaluate the space-fillingness of the Latin</span>
<span class="sd">            hypercube. The best plan is selected based on the lowest mmphi value.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray:</span>
<span class="sd">            A 2D array of shape (n, k) representing an optimized Latin hypercube.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from spotoptim.sampling.mm import bestlh</span>
<span class="sd">        # Generate a 5-point, 2-dimensional Latin hypercube</span>
<span class="sd">        &gt;&gt;&gt; X = bestlh(n=5, k=2, population=5, iterations=10)</span>
<span class="sd">        &gt;&gt;&gt; print(X.shape)</span>
<span class="sd">        (5, 2)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Latin hypercubes require at least 2 points&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Latin hypercubes are not defined for dim k &lt; 2&quot;</span><span class="p">)</span>

    <span class="c1"># Start with a random Latin hypercube</span>
    <span class="n">X_start</span> <span class="o">=</span> <span class="n">rlh</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">edges</span><span class="o">=</span><span class="n">edges</span><span class="p">)</span>

    <span class="c1"># Allocate a 3D array to store the results for each q</span>
    <span class="c1"># (shape: (n, k, number_of_q_values))</span>
    <span class="n">X3D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">q_list</span><span class="p">)))</span>

    <span class="c1"># Evolve the plan for each q in q_list</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">q_val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">q_list</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Now optimizing for q=</span><span class="si">{</span><span class="n">q_val</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
        <span class="n">X3D</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">mmlhs</span><span class="p">(</span><span class="n">X_start</span><span class="p">,</span> <span class="n">population</span><span class="p">,</span> <span class="n">iterations</span><span class="p">,</span> <span class="n">q_val</span><span class="p">)</span>

    <span class="c1"># Sort the set of evolved plans according to the Morris-Mitchell criterion</span>
    <span class="n">index_order</span> <span class="o">=</span> <span class="n">mmsort</span><span class="p">(</span><span class="n">X3D</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

    <span class="c1"># index_order is a 1-based array of plan indices; the first element is the best</span>
    <span class="n">best_idx</span> <span class="o">=</span> <span class="n">index_order</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Best lh found using q=</span><span class="si">{</span><span class="n">q_list</span><span class="p">[</span><span class="n">best_idx</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

    <span class="c1"># The best plan in 3D array order</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">X3D</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">best_idx</span><span class="p">]</span>

    <span class="c1"># Plot the first two dimensions</span>
    <span class="k">if</span> <span class="n">plot</span> <span class="ow">and</span> <span class="p">(</span><span class="n">k</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Morris-Mitchell optimum plan found using q=</span><span class="si">{</span><span class="n">q_list</span><span class="p">[</span><span class="n">best_idx</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x_1&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;x_2&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">X</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="spotoptim.sampling.mm.jd" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">jd</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span></code>

<a href="#spotoptim.sampling.mm.jd" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Computes and counts the distinct p-norm distances between all pairs of points in X.
It returns:
1) A list of distinct distances (sorted), and
2) A corresponding multiplicity array that indicates how often each distance occurs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 2D array of shape (n, d) representing n points in d-dimensional space.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The distance norm to use. p=1 uses the Manhattan (L1) norm, while p=2 uses the
Euclidean (L2) norm. Defaults to 1.0 (Manhattan norm).</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>(<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple (J, distinct_d), where:
- distinct_d is a 1D float array of unique, sorted distances between points.
- J is a 1D integer array that provides the multiplicity (occurrence count)
  of each distance in distinct_d.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>Many thanks to the original author of this code, A Sobester, for providing the original Matlab code
under the GNU Licence. Original Matlab Code: Copyright 2007 A Sobester:
&ldquo;This program is free software: you can redistribute it and/or modify  it
under the terms of the GNU Lesser General Public License as published by
the Free Software Foundation, either version 3 of the License, or any
later version.
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
General Public License for more details.
You should have received a copy of the GNU General Public License and GNU
Lesser General Public License along with this program. If not, see
<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.&rdquo;</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotoptim.sampling.mm</span><span class="w"> </span><span class="kn">import</span> <span class="n">jd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># A small 3-point set in 2D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">J</span><span class="p">,</span> <span class="n">distinct_d</span> <span class="o">=</span> <span class="n">jd</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Distinct distances:&quot;</span><span class="p">,</span> <span class="n">distinct_d</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Occurrences:&quot;</span><span class="p">,</span> <span class="n">J</span><span class="p">)</span>
<span class="go"># Possible output (using Euclidean norm):</span>
<span class="go"># Distinct distances: [1.41421356 2.82842712]</span>
<span class="go"># Occurrences: [1 1]</span>
<span class="go"># Explanation: Distances are sqrt(2) between consecutive points and 2*sqrt(2) for the farthest pair.</span>
<span class="go">    Distinct distances: [1.41421356 2.82842712]</span>
<span class="go">    Occurrences: [2 1]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotoptim/sampling/mm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">jd</span><span class="p">(</span><span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes and counts the distinct p-norm distances between all pairs of points in X.</span>
<span class="sd">    It returns:</span>
<span class="sd">    1) A list of distinct distances (sorted), and</span>
<span class="sd">    2) A corresponding multiplicity array that indicates how often each distance occurs.</span>

<span class="sd">    Args:</span>
<span class="sd">        X (np.ndarray):</span>
<span class="sd">            A 2D array of shape (n, d) representing n points in d-dimensional space.</span>
<span class="sd">        p (float, optional):</span>
<span class="sd">            The distance norm to use. p=1 uses the Manhattan (L1) norm, while p=2 uses the</span>
<span class="sd">            Euclidean (L2) norm. Defaults to 1.0 (Manhattan norm).</span>

<span class="sd">    Returns:</span>
<span class="sd">        (np.ndarray, np.ndarray):</span>
<span class="sd">            A tuple (J, distinct_d), where:</span>
<span class="sd">            - distinct_d is a 1D float array of unique, sorted distances between points.</span>
<span class="sd">            - J is a 1D integer array that provides the multiplicity (occurrence count)</span>
<span class="sd">              of each distance in distinct_d.</span>

<span class="sd">    Notes:</span>
<span class="sd">        Many thanks to the original author of this code, A Sobester, for providing the original Matlab code</span>
<span class="sd">        under the GNU Licence. Original Matlab Code: Copyright 2007 A Sobester:</span>
<span class="sd">        &quot;This program is free software: you can redistribute it and/or modify  it</span>
<span class="sd">        under the terms of the GNU Lesser General Public License as published by</span>
<span class="sd">        the Free Software Foundation, either version 3 of the License, or any</span>
<span class="sd">        later version.</span>
<span class="sd">        This program is distributed in the hope that it will be useful, but</span>
<span class="sd">        WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">        MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser</span>
<span class="sd">        General Public License for more details.</span>
<span class="sd">        You should have received a copy of the GNU General Public License and GNU</span>
<span class="sd">        Lesser General Public License along with this program. If not, see</span>
<span class="sd">        &lt;http://www.gnu.org/licenses/&gt;.&quot;</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from spotoptim.sampling.mm import jd</span>
<span class="sd">        &gt;&gt;&gt; # A small 3-point set in 2D</span>
<span class="sd">        &gt;&gt;&gt; X = np.array([[0.0, 0.0],</span>
<span class="sd">        ...               [1.0, 1.0],</span>
<span class="sd">        ...               [2.0, 2.0]])</span>
<span class="sd">        &gt;&gt;&gt; J, distinct_d = jd(X, p=2.0)</span>
<span class="sd">        &gt;&gt;&gt; print(&quot;Distinct distances:&quot;, distinct_d)</span>
<span class="sd">        &gt;&gt;&gt; print(&quot;Occurrences:&quot;, J)</span>
<span class="sd">        # Possible output (using Euclidean norm):</span>
<span class="sd">        # Distinct distances: [1.41421356 2.82842712]</span>
<span class="sd">        # Occurrences: [1 1]</span>
<span class="sd">        # Explanation: Distances are sqrt(2) between consecutive points and 2*sqrt(2) for the farthest pair.</span>
<span class="sd">            Distinct distances: [1.41421356 2.82842712]</span>
<span class="sd">            Occurrences: [2 1]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Allocate enough space for all pairwise distances</span>
    <span class="c1"># (n*(n-1))/2 pairs for an n-point set</span>
    <span class="n">pair_count</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">pair_count</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

    <span class="c1"># Fill the distance array</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
            <span class="c1"># Compute the p-norm distance</span>
            <span class="n">d</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="nb">ord</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
            <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># Find unique distances and their multiplicities</span>
    <span class="n">distinct_d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">J</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">distinct_d</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">distinct_d</span><span class="p">):</span>
        <span class="n">J</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">d</span> <span class="o">==</span> <span class="n">val</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">J</span><span class="p">,</span> <span class="n">distinct_d</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="spotoptim.sampling.mm.mm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mm</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span></code>

<a href="#spotoptim.sampling.mm.mm" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Determines which of two sampling plans has better space-filling properties
according to the Morris-Mitchell criterion.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X1</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 2D array representing the first sampling plan.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>X2</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 2D array representing the second sampling plan.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The distance metric. p=1 uses Manhattan (L1) distance,
while p=2 uses Euclidean (L2). Defaults to 1.0.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>int</code></td>            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <ul>
<li>0 if both plans are identical or equally space-filling</li>
<li>1 if X1 is more space-filling</li>
<li>2 if X2 is more space-filling</li>
</ul>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>Many thanks to the original author of this code, A Sobester, for providing the original Matlab code
under the GNU Licence. Original Matlab Code: Copyright 2007 A Sobester:
&ldquo;This program is free software: you can redistribute it and/or modify  it
under the terms of the GNU Lesser General Public License as published by
the Free Software Foundation, either version 3 of the License, or any
later version.
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
General Public License for more details.
You should have received a copy of the GNU General Public License and GNU
Lesser General Public License along with this program. If not, see
<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.&rdquo;</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotoptim.sampling.mm</span><span class="w"> </span><span class="kn">import</span> <span class="n">mm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create two 3-point sampling plans in 2D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Compare which plan has better space-filling (Morris-Mitchell)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">better</span> <span class="o">=</span> <span class="n">mm</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">better</span><span class="p">)</span>
<span class="go"># Prints either 0, 1, or 2 depending on which plan is more space-filling.</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotoptim/sampling/mm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mm</span><span class="p">(</span><span class="n">X1</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">X2</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determines which of two sampling plans has better space-filling properties</span>
<span class="sd">    according to the Morris-Mitchell criterion.</span>

<span class="sd">    Args:</span>
<span class="sd">        X1 (np.ndarray): A 2D array representing the first sampling plan.</span>
<span class="sd">        X2 (np.ndarray): A 2D array representing the second sampling plan.</span>
<span class="sd">        p (float, optional): The distance metric. p=1 uses Manhattan (L1) distance,</span>
<span class="sd">            while p=2 uses Euclidean (L2). Defaults to 1.0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        int:</span>
<span class="sd">            - 0 if both plans are identical or equally space-filling</span>
<span class="sd">            - 1 if X1 is more space-filling</span>
<span class="sd">            - 2 if X2 is more space-filling</span>

<span class="sd">    Notes:</span>
<span class="sd">        Many thanks to the original author of this code, A Sobester, for providing the original Matlab code</span>
<span class="sd">        under the GNU Licence. Original Matlab Code: Copyright 2007 A Sobester:</span>
<span class="sd">        &quot;This program is free software: you can redistribute it and/or modify  it</span>
<span class="sd">        under the terms of the GNU Lesser General Public License as published by</span>
<span class="sd">        the Free Software Foundation, either version 3 of the License, or any</span>
<span class="sd">        later version.</span>
<span class="sd">        This program is distributed in the hope that it will be useful, but</span>
<span class="sd">        WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">        MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser</span>
<span class="sd">        General Public License for more details.</span>
<span class="sd">        You should have received a copy of the GNU General Public License and GNU</span>
<span class="sd">        Lesser General Public License along with this program. If not, see</span>
<span class="sd">        &lt;http://www.gnu.org/licenses/&gt;.&quot;</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from spotoptim.sampling.mm import mm</span>
<span class="sd">        &gt;&gt;&gt; # Create two 3-point sampling plans in 2D</span>
<span class="sd">        &gt;&gt;&gt; X1 = np.array([[0.0, 0.0],</span>
<span class="sd">        ...                [0.5, 0.5],</span>
<span class="sd">        ...                [0.0, 1.0]])</span>
<span class="sd">        &gt;&gt;&gt; X2 = np.array([[0.1, 0.1],</span>
<span class="sd">        ...                [0.4, 0.6],</span>
<span class="sd">        ...                [0.1, 0.9]])</span>
<span class="sd">        &gt;&gt;&gt; # Compare which plan has better space-filling (Morris-Mitchell)</span>
<span class="sd">        &gt;&gt;&gt; better = mm(X1, X2, p=2.0)</span>
<span class="sd">        &gt;&gt;&gt; print(better)</span>
<span class="sd">        # Prints either 0, 1, or 2 depending on which plan is more space-filling.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Quick check if the sorted sets of points are identical</span>
    <span class="c1"># (mimicking MATLAB&#39;s sortrows check)</span>
    <span class="n">X1_sorted</span> <span class="o">=</span> <span class="n">X1</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">X1</span><span class="p">))]</span>
    <span class="n">X2_sorted</span> <span class="o">=</span> <span class="n">X2</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">X2</span><span class="p">))]</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">X1_sorted</span><span class="p">,</span> <span class="n">X2_sorted</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># Identical sampling plans</span>

    <span class="c1"># Compute distance multiplicities for each plan</span>
    <span class="n">J1</span><span class="p">,</span> <span class="n">d1</span> <span class="o">=</span> <span class="n">jd</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">J2</span><span class="p">,</span> <span class="n">d2</span> <span class="o">=</span> <span class="n">jd</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">m1</span><span class="p">,</span> <span class="n">m2</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">d1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">d2</span><span class="p">)</span>

    <span class="c1"># Construct V1 and V2: alternate distance and negative multiplicity</span>
    <span class="n">V1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m1</span><span class="p">)</span>
    <span class="n">V1</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">d1</span>
    <span class="n">V1</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">J1</span>

    <span class="n">V2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m2</span><span class="p">)</span>
    <span class="n">V2</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">d2</span>
    <span class="n">V2</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">J2</span>

    <span class="c1"># Trim the longer vector to match the size of the shorter</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">)</span>
    <span class="n">V1</span> <span class="o">=</span> <span class="n">V1</span><span class="p">[:</span><span class="n">m</span><span class="p">]</span>
    <span class="n">V2</span> <span class="o">=</span> <span class="n">V2</span><span class="p">[:</span><span class="n">m</span><span class="p">]</span>

    <span class="c1"># Compare element-by-element:</span>
    <span class="c1"># c[i] = 1 if V1[i] &gt; V2[i], 2 if V1[i] &lt; V2[i], 0 otherwise.</span>
    <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">V1</span> <span class="o">&gt;</span> <span class="n">V2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">V1</span> <span class="o">&lt;</span> <span class="n">V2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Equally space-filling</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># The first non-zero entry indicates which plan is better</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">c</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">c</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="spotoptim.sampling.mm.mm_improvement" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mm_improvement</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">X_base</span><span class="p">,</span> <span class="n">phi_base</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">J_base</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">d_base</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">normalize_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">exponential</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#spotoptim.sampling.mm.mm_improvement" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculates the Morris-Mitchell improvement for a candidate point x.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>x</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Candidate point (1D array).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>X_base</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Existing design points.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>J_base</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Multiplicities of distances for X_base.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>d_base</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unique distances for X_base.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of nearest neighbors for MM metric.</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Power for MM metric.</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>normalize_flag</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, normalizes the X array and candidate point before computing distances. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>exponential</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the exponential is applied.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Morris-Mitchell improvement.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotoptim.sampling.mm</span><span class="w"> </span><span class="kn">import</span> <span class="n">mm_improvement</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_base</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">improvement</span> <span class="o">=</span> <span class="n">mm_improvement</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">X_base</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">improvement</span><span class="p">)</span>
<span class="go">0.123456789</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotoptim/sampling/mm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mm_improvement</span><span class="p">(</span>
    <span class="n">x</span><span class="p">,</span>
    <span class="n">X_base</span><span class="p">,</span>
    <span class="n">phi_base</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">J_base</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">d_base</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">q</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">normalize_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">exponential</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Morris-Mitchell improvement for a candidate point x.</span>

<span class="sd">    Args:</span>
<span class="sd">        x (np.ndarray): Candidate point (1D array).</span>
<span class="sd">        X_base (np.ndarray): Existing design points.</span>
<span class="sd">        J_base (np.ndarray): Multiplicities of distances for X_base.</span>
<span class="sd">        d_base (np.ndarray): Unique distances for X_base.</span>
<span class="sd">        q (int): Number of nearest neighbors for MM metric.</span>
<span class="sd">        p (int): Power for MM metric.</span>
<span class="sd">        normalize_flag (bool): If True, normalizes the X array and candidate point before computing distances. Defaults to False.</span>
<span class="sd">        exponential (bool): If True, the exponential is applied.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: Morris-Mitchell improvement.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from spotoptim.sampling.mm import mm_improvement</span>
<span class="sd">        &gt;&gt;&gt; X_base = np.array([[0.1, 0.2], [0.4, 0.5], [0.7, 0.8]])</span>
<span class="sd">        &gt;&gt;&gt; x = np.array([0.5, 0.5])</span>
<span class="sd">        &gt;&gt;&gt; improvement = mm_improvement(x, X_base, q=2, p=2)</span>
<span class="sd">        &gt;&gt;&gt; print(improvement)</span>
<span class="sd">        0.123456789</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">phi_base</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">J_base</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">d_base</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">phi_base</span><span class="p">,</span> <span class="n">J_base</span><span class="p">,</span> <span class="n">d_base</span> <span class="o">=</span> <span class="n">mmphi_intensive</span><span class="p">(</span>
            <span class="n">X_base</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">normalize_flag</span><span class="o">=</span><span class="n">normalize_flag</span>
        <span class="p">)</span>
    <span class="n">phi_new</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mmphi_intensive_update</span><span class="p">(</span>
        <span class="n">X_base</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">J_base</span><span class="p">,</span> <span class="n">d_base</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">normalize_flag</span><span class="o">=</span><span class="n">normalize_flag</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">exponential</span><span class="p">:</span>
        <span class="n">y_mm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">phi_base</span> <span class="o">-</span> <span class="n">phi_new</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">y_mm</span> <span class="o">=</span> <span class="n">phi_base</span> <span class="o">-</span> <span class="n">phi_new</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Morris-Mitchell base: </span><span class="si">{</span><span class="n">phi_base</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Morris-Mitchell new: </span><span class="si">{</span><span class="n">phi_new</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Morris-Mitchell improvement: </span><span class="si">{</span><span class="n">y_mm</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">y_mm</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="spotoptim.sampling.mm.mm_improvement_contour" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mm_improvement_contour</span><span class="p">(</span><span class="n">X_base</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">x2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">q</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></code>

<a href="#spotoptim.sampling.mm.mm_improvement_contour" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Generates a contour plot of the Morris-Mitchell improvement over a grid defined by x1 and x2.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X_base</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base design points.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x1</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Grid values for the first dimension. Default is np.linspace(0, 1, 100).</p>
              </div>
            </td>
            <td>
                  <code><span title="numpy.linspace">linspace</span>(0, 1, 100)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x2</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Grid values for the second dimension. Default is np.linspace(0, 1, 100).</p>
              </div>
            </td>
            <td>
                  <code><span title="numpy.linspace">linspace</span>(0, 1, 100)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Morris-Mitchell metric parameter. Default is 2.</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Morris-Mitchell metric parameter. Default is 2.</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns:
    None: Displays a contour plot of the Morris-Mitchell improvement.</p>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotoptim.sampling.mm import mm_improvement_contour</span>
<span class="go">    X_base = np.array([[0.1, 0.1], [0.2, 0.2], [0.7, 0.7]])</span>
<span class="go">    mm_improvement_contour(X_base)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotoptim/sampling/mm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mm_improvement_contour</span><span class="p">(</span>
    <span class="n">X_base</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">x2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">q</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a contour plot of the Morris-Mitchell improvement over a grid defined by x1 and x2.</span>

<span class="sd">    Args:</span>
<span class="sd">        X_base (np.ndarray):</span>
<span class="sd">            Base design points.</span>
<span class="sd">        x1 (np.ndarray):</span>
<span class="sd">            Grid values for the first dimension. Default is np.linspace(0, 1, 100).</span>
<span class="sd">        x2 (np.ndarray): Grid values for the second dimension. Default is np.linspace(0, 1, 100).</span>
<span class="sd">        q (int):</span>
<span class="sd">            Morris-Mitchell metric parameter. Default is 2.</span>
<span class="sd">        p (int):</span>
<span class="sd">            Morris-Mitchell metric parameter. Default is 2.</span>
<span class="sd">    Returns:</span>
<span class="sd">        None: Displays a contour plot of the Morris-Mitchell improvement.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotoptim.sampling.mm import mm_improvement_contour</span>
<span class="sd">            X_base = np.array([[0.1, 0.1], [0.2, 0.2], [0.7, 0.7]])</span>
<span class="sd">            mm_improvement_contour(X_base)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_</span><span class="p">,</span> <span class="n">J_base</span><span class="p">,</span> <span class="n">d_base</span> <span class="o">=</span> <span class="n">mmphi_intensive</span><span class="p">(</span><span class="n">X_base</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">)</span>
    <span class="n">improvement_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">X1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">X2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]])</span>
            <span class="n">improvement_grid</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">mm_improvement</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">X_base</span><span class="p">,</span> <span class="n">J_base</span><span class="p">,</span> <span class="n">d_base</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">improvement_grid</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Morris-Mitchell Improvement&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_base</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_base</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;X_base&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Morris-Mitchell Improvement Contour Plot&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;X1&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;X2&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="spotoptim.sampling.mm.mmlhs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mmlhs</span><span class="p">(</span><span class="n">X_start</span><span class="p">,</span> <span class="n">population</span><span class="p">,</span> <span class="n">iterations</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#spotoptim.sampling.mm.mmlhs" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Performs an evolutionary search (using perturbations) to find a Morris-Mitchell
optimal Latin hypercube, starting from an initial plan X_start.</p>


<details class="this-function-does-the-following" open>
  <summary>This function does the following</summary>
  <ol>
<li>Initializes a &ldquo;best&rdquo; Latin hypercube (X_best) from the provided X_start.</li>
<li>Iteratively perturbs X_best to create offspring.</li>
<li>Evaluates the space-fillingness of each offspring via the Morris-Mitchell
   metric (using mmphi).</li>
<li>Updates the best plan whenever a better offspring is found.</li>
</ol>
</details>

<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X_start</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 2D array of shape (n, k) providing the initial Latin hypercube
(n points in k dimensions).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>population</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of offspring to create in each generation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>iterations</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Total number of generations to run the evolutionary search.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The exponent used by the Morris-Mitchell space-filling criterion.
Defaults to 2.0.</p>
              </div>
            </td>
            <td>
                  <code>2.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>plot</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, a simple scatter plot of the first two dimensions will be
displayed at each iteration. Only if k &gt;= 2. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray:
A 2D array representing the most space-filling Latin hypercube found
after all iterations, of the same shape as X_start.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>Many thanks to the original author of this code, A Sobester, for providing the original Matlab code
under the GNU Licence. Original Matlab Code: Copyright 2007 A Sobester:
&ldquo;This program is free software: you can redistribute it and/or modify  it
under the terms of the GNU Lesser General Public License as published by
the Free Software Foundation, either version 3 of the License, or any
later version.
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
General Public License for more details.
You should have received a copy of the GNU General Public License and GNU
Lesser General Public License along with this program. If not, see
<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.&rdquo;</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotoptim.sampling.mm</span><span class="w"> </span><span class="kn">import</span> <span class="n">mmlhs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Suppose we have an initial 4x2 plan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Search for a more space-filling plan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_opt</span> <span class="o">=</span> <span class="n">mmlhs</span><span class="p">(</span><span class="n">X_start</span><span class="p">,</span> <span class="n">population</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimized plan:&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">X_opt</span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotoptim/sampling/mm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mmlhs</span><span class="p">(</span>
    <span class="n">X_start</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">population</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">iterations</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">q</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs an evolutionary search (using perturbations) to find a Morris-Mitchell</span>
<span class="sd">    optimal Latin hypercube, starting from an initial plan X_start.</span>

<span class="sd">    This function does the following:</span>
<span class="sd">      1. Initializes a &quot;best&quot; Latin hypercube (X_best) from the provided X_start.</span>
<span class="sd">      2. Iteratively perturbs X_best to create offspring.</span>
<span class="sd">      3. Evaluates the space-fillingness of each offspring via the Morris-Mitchell</span>
<span class="sd">         metric (using mmphi).</span>
<span class="sd">      4. Updates the best plan whenever a better offspring is found.</span>

<span class="sd">    Args:</span>
<span class="sd">        X_start (np.ndarray):</span>
<span class="sd">            A 2D array of shape (n, k) providing the initial Latin hypercube</span>
<span class="sd">            (n points in k dimensions).</span>
<span class="sd">        population (int):</span>
<span class="sd">            Number of offspring to create in each generation.</span>
<span class="sd">        iterations (int):</span>
<span class="sd">            Total number of generations to run the evolutionary search.</span>
<span class="sd">        q (float, optional):</span>
<span class="sd">            The exponent used by the Morris-Mitchell space-filling criterion.</span>
<span class="sd">            Defaults to 2.0.</span>
<span class="sd">        plot (bool, optional):</span>
<span class="sd">            If True, a simple scatter plot of the first two dimensions will be</span>
<span class="sd">            displayed at each iteration. Only if k &gt;= 2. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray:</span>
<span class="sd">            A 2D array representing the most space-filling Latin hypercube found</span>
<span class="sd">            after all iterations, of the same shape as X_start.</span>

<span class="sd">    Notes:</span>
<span class="sd">        Many thanks to the original author of this code, A Sobester, for providing the original Matlab code</span>
<span class="sd">        under the GNU Licence. Original Matlab Code: Copyright 2007 A Sobester:</span>
<span class="sd">        &quot;This program is free software: you can redistribute it and/or modify  it</span>
<span class="sd">        under the terms of the GNU Lesser General Public License as published by</span>
<span class="sd">        the Free Software Foundation, either version 3 of the License, or any</span>
<span class="sd">        later version.</span>
<span class="sd">        This program is distributed in the hope that it will be useful, but</span>
<span class="sd">        WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">        MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser</span>
<span class="sd">        General Public License for more details.</span>
<span class="sd">        You should have received a copy of the GNU General Public License and GNU</span>
<span class="sd">        Lesser General Public License along with this program. If not, see</span>
<span class="sd">        &lt;http://www.gnu.org/licenses/&gt;.&quot;</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from spotoptim.sampling.mm import mmlhs</span>
<span class="sd">        &gt;&gt;&gt; # Suppose we have an initial 4x2 plan</span>
<span class="sd">        &gt;&gt;&gt; X_start = np.array([</span>
<span class="sd">        ...     [0, 0],</span>
<span class="sd">        ...     [1, 3],</span>
<span class="sd">        ...     [2, 1],</span>
<span class="sd">        ...     [3, 2]</span>
<span class="sd">        ... ])</span>
<span class="sd">        &gt;&gt;&gt; # Search for a more space-filling plan</span>
<span class="sd">        &gt;&gt;&gt; X_opt = mmlhs(X_start, population=5, iterations=10, q=2)</span>
<span class="sd">        &gt;&gt;&gt; print(&quot;Optimized plan:&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(X_opt)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">X_start</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Latin hypercubes require at least 2 points&quot;</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">X_start</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Latin hypercubes are not defined for dim k &lt; 2&quot;</span><span class="p">)</span>

    <span class="c1"># Initialize best plan and its metric</span>
    <span class="n">X_best</span> <span class="o">=</span> <span class="n">X_start</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">Phi_best</span> <span class="o">=</span> <span class="n">mmphi</span><span class="p">(</span><span class="n">X_best</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">)</span>

    <span class="c1"># After 85% of iterations, reduce the mutation rate to 1</span>
    <span class="n">leveloff</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="mf">0.85</span> <span class="o">*</span> <span class="n">iterations</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">iterations</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="c1"># Decrease number of mutations over time</span>
        <span class="k">if</span> <span class="n">it</span> <span class="o">&lt;</span> <span class="n">leveloff</span><span class="p">:</span>
            <span class="n">mutations</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">leveloff</span> <span class="o">-</span> <span class="n">it</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">leveloff</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mutations</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">X_improved</span> <span class="o">=</span> <span class="n">X_best</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">Phi_improved</span> <span class="o">=</span> <span class="n">Phi_best</span>

        <span class="c1"># Create offspring, evaluate, and keep the best</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">population</span><span class="p">):</span>
            <span class="n">X_try</span> <span class="o">=</span> <span class="n">perturb</span><span class="p">(</span><span class="n">X_best</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">mutations</span><span class="p">)</span>
            <span class="n">Phi_try</span> <span class="o">=</span> <span class="n">mmphi</span><span class="p">(</span><span class="n">X_try</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">Phi_try</span> <span class="o">&lt;</span> <span class="n">Phi_improved</span><span class="p">:</span>
                <span class="n">X_improved</span> <span class="o">=</span> <span class="n">X_try</span>
                <span class="n">Phi_improved</span> <span class="o">=</span> <span class="n">Phi_try</span>

        <span class="c1"># Update the global best if we found a better plan</span>
        <span class="k">if</span> <span class="n">Phi_improved</span> <span class="o">&lt;</span> <span class="n">Phi_best</span><span class="p">:</span>
            <span class="n">X_best</span> <span class="o">=</span> <span class="n">X_improved</span>
            <span class="n">Phi_best</span> <span class="o">=</span> <span class="n">Phi_improved</span>

        <span class="c1"># Simple visualization of the first two dimensions</span>
        <span class="k">if</span> <span class="n">plot</span> <span class="ow">and</span> <span class="p">(</span><span class="n">X_best</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_best</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_best</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Iteration </span><span class="si">{</span><span class="n">it</span><span class="si">}</span><span class="s2"> - Current Best Plan&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">X_best</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="spotoptim.sampling.mm.mmphi" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mmphi</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#spotoptim.sampling.mm.mmphi" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculates the Morris-Mitchell sampling plan quality criterion.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 2D array representing the sampling plan, where each row is a point in
d-dimensional space (shape: (n, d)).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exponent used in the computation of the metric. Defaults to 2.0.</p>
              </div>
            </td>
            <td>
                  <code>2.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The distance norm to use. For example, p=1 is Manhattan (L1),
p=2 is Euclidean (L2). Defaults to 1.0.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbosity</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If set to 1, prints additional information about the computation.
Defaults to 0 (no additional output).</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The space-fillingness metric Phiq. Larger values typically indicate a more
space-filling plan according to the Morris-Mitchell criterion.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>Many thanks to the original author of this code, A Sobester, for providing the original Matlab code
under the GNU Licence. Original Matlab Code: Copyright 2007 A Sobester:
&ldquo;This program is free software: you can redistribute it and/or modify  it
under the terms of the GNU Lesser General Public License as published by
the Free Software Foundation, either version 3 of the License, or any
later version.
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
General Public License for more details.
You should have received a copy of the GNU General Public License and GNU
Lesser General Public License along with this program. If not, see
<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.&rdquo;</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotoptim.sampling.mm</span><span class="w"> </span><span class="kn">import</span> <span class="n">mmphi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simple 3-point sampling plan in 2D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate the space-fillingness metric with q=2, using Euclidean distances (p=2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quality</span> <span class="o">=</span> <span class="n">mmphi</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">quality</span><span class="p">)</span>
<span class="go"># This value indicates how well points are spread out, with smaller being better.</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotoptim/sampling/mm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mmphi</span><span class="p">(</span>
    <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the Morris-Mitchell sampling plan quality criterion.</span>

<span class="sd">    Args:</span>
<span class="sd">        X (np.ndarray):</span>
<span class="sd">            A 2D array representing the sampling plan, where each row is a point in</span>
<span class="sd">            d-dimensional space (shape: (n, d)).</span>
<span class="sd">        q (float, optional):</span>
<span class="sd">            Exponent used in the computation of the metric. Defaults to 2.0.</span>
<span class="sd">        p (float, optional):</span>
<span class="sd">            The distance norm to use. For example, p=1 is Manhattan (L1),</span>
<span class="sd">            p=2 is Euclidean (L2). Defaults to 1.0.</span>
<span class="sd">        verbosity (int, optional):</span>
<span class="sd">            If set to 1, prints additional information about the computation.</span>
<span class="sd">            Defaults to 0 (no additional output).</span>

<span class="sd">    Returns:</span>
<span class="sd">        float:</span>
<span class="sd">            The space-fillingness metric Phiq. Larger values typically indicate a more</span>
<span class="sd">            space-filling plan according to the Morris-Mitchell criterion.</span>

<span class="sd">    Notes:</span>
<span class="sd">        Many thanks to the original author of this code, A Sobester, for providing the original Matlab code</span>
<span class="sd">        under the GNU Licence. Original Matlab Code: Copyright 2007 A Sobester:</span>
<span class="sd">        &quot;This program is free software: you can redistribute it and/or modify  it</span>
<span class="sd">        under the terms of the GNU Lesser General Public License as published by</span>
<span class="sd">        the Free Software Foundation, either version 3 of the License, or any</span>
<span class="sd">        later version.</span>
<span class="sd">        This program is distributed in the hope that it will be useful, but</span>
<span class="sd">        WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">        MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser</span>
<span class="sd">        General Public License for more details.</span>
<span class="sd">        You should have received a copy of the GNU General Public License and GNU</span>
<span class="sd">        Lesser General Public License along with this program. If not, see</span>
<span class="sd">        &lt;http://www.gnu.org/licenses/&gt;.&quot;</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from spotoptim.sampling.mm import mmphi</span>
<span class="sd">        &gt;&gt;&gt; # Simple 3-point sampling plan in 2D</span>
<span class="sd">        &gt;&gt;&gt; X = np.array([</span>
<span class="sd">        ...     [0.0, 0.0],</span>
<span class="sd">        ...     [0.5, 0.5],</span>
<span class="sd">        ...     [1.0, 1.0]</span>
<span class="sd">        ... ])</span>
<span class="sd">        &gt;&gt;&gt; # Calculate the space-fillingness metric with q=2, using Euclidean distances (p=2)</span>
<span class="sd">        &gt;&gt;&gt; quality = mmphi(X, q=2, p=2)</span>
<span class="sd">        &gt;&gt;&gt; print(quality)</span>
<span class="sd">        # This value indicates how well points are spread out, with smaller being better.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># check that X has unique rows</span>
    <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)):</span>
        <span class="c1"># issue a warning if there are duplicate rows</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;Warning: X contains duplicate rows. This may affect the space-fillingness metric.&quot;</span>
        <span class="p">)</span>
        <span class="c1"># make X unique</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># Compute the distance multiplicities: J, and unique distances: d</span>
    <span class="n">J</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">jd</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;J: </span><span class="si">{</span><span class="n">J</span><span class="si">}</span><span class="s2">, d: </span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">verbosity</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="c1"># Summation of J[i] * d[i]^(-q), then raised to 1/q</span>
    <span class="c1"># This follows the Morris-Mitchell definition.</span>
    <span class="n">Phiq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">J</span> <span class="o">*</span> <span class="p">(</span><span class="n">d</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="p">)))</span> <span class="o">**</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">q</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Phiq</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="spotoptim.sampling.mm.mmphi_intensive" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mmphi_intensive</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">normalize_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#spotoptim.sampling.mm.mmphi_intensive" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Calculates a size-invariant Morris-Mitchell criterion.</p>
<p>This &ldquo;intensive&rdquo; version of the criterion allows for the comparison of
sampling plans with different sample sizes by normalizing for the number
of point pairs. A smaller value indicates a better (more space-filling)
design.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 2D array representing the sampling plan (shape: (n, d)).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The exponent used in the computation of the metric. Defaults to 2.0.</p>
              </div>
            </td>
            <td>
                  <code>2.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The distance norm to use (e.g., p=1 for Manhattan, p=2 for Euclidean).
Defaults to 2.0.</p>
              </div>
            </td>
            <td>
                  <code>2.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>normalize_flag</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, normalizes the X array before computing distances.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[float, np.ndarray, np.ndarray]:
A tuple containing:
- intensive_phiq: The intensive space-fillingness metric.
- J: Multiplicities of distances.
- d: Unique distances.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotoptim.sampling.mm</span><span class="w"> </span><span class="kn">import</span> <span class="n">mmphi_intensive</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a simple 3-point sampling plan in 2D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate the intensive space-fillingness metric with q=2, using Euclidean distances (p=2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quality</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">mmphi_intensive</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">quality</span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotoptim/sampling/mm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mmphi_intensive</span><span class="p">(</span>
    <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">q</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="n">p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="n">normalize_flag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates a size-invariant Morris-Mitchell criterion.</span>

<span class="sd">    This &quot;intensive&quot; version of the criterion allows for the comparison of</span>
<span class="sd">    sampling plans with different sample sizes by normalizing for the number</span>
<span class="sd">    of point pairs. A smaller value indicates a better (more space-filling)</span>
<span class="sd">    design.</span>

<span class="sd">    Args:</span>
<span class="sd">        X (np.ndarray):</span>
<span class="sd">            A 2D array representing the sampling plan (shape: (n, d)).</span>
<span class="sd">        q (float, optional):</span>
<span class="sd">            The exponent used in the computation of the metric. Defaults to 2.0.</span>
<span class="sd">        p (float, optional):</span>
<span class="sd">            The distance norm to use (e.g., p=1 for Manhattan, p=2 for Euclidean).</span>
<span class="sd">            Defaults to 2.0.</span>
<span class="sd">        normalize_flag (bool, optional):</span>
<span class="sd">            If True, normalizes the X array before computing distances.</span>
<span class="sd">            Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[float, np.ndarray, np.ndarray]:</span>
<span class="sd">            A tuple containing:</span>
<span class="sd">            - intensive_phiq: The intensive space-fillingness metric.</span>
<span class="sd">            - J: Multiplicities of distances.</span>
<span class="sd">            - d: Unique distances.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from spotoptim.sampling.mm import mmphi_intensive</span>
<span class="sd">        &gt;&gt;&gt; # Create a simple 3-point sampling plan in 2D</span>
<span class="sd">        &gt;&gt;&gt; X = np.array([</span>
<span class="sd">        ...     [0.0, 0.0],</span>
<span class="sd">        ...     [0.5, 0.5],</span>
<span class="sd">        ...     [1.0, 1.0]</span>
<span class="sd">        ... ])</span>
<span class="sd">        &gt;&gt;&gt; # Calculate the intensive space-fillingness metric with q=2, using Euclidean distances (p=2)</span>
<span class="sd">        &gt;&gt;&gt; quality, J, d = mmphi_intensive(X, q=2, p=2)</span>
<span class="sd">        &gt;&gt;&gt; print(quality)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Ensure there are no duplicate points</span>
    <span class="k">if</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)):</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">n_points</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Normalize X to [0, 1] in each dimension if requested</span>
    <span class="k">if</span> <span class="n">normalize_flag</span><span class="p">:</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">normalize_X</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

    <span class="c1"># The criterion is not well-defined for fewer than 2 points.</span>
    <span class="k">if</span> <span class="n">n_points</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>

    <span class="c1"># Get the unique distances and their multiplicities</span>
    <span class="n">J</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">jd</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

    <span class="c1"># If all points are identical, the design is infinitely bad.</span>
    <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">d</span>

    <span class="c1"># Calculate the number of unique pairs of points</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">n_points</span> <span class="o">*</span> <span class="p">(</span><span class="n">n_points</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Calculate the sum term of the original mmphi</span>
        <span class="n">sum_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">J</span> <span class="o">*</span> <span class="p">(</span><span class="n">d</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="p">)))</span>
        <span class="c1"># Normalize the sum by M before taking the final root</span>
        <span class="n">intensive_phiq</span> <span class="o">=</span> <span class="p">(</span><span class="n">sum_term</span> <span class="o">/</span> <span class="n">M</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">q</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
    <span class="k">except</span> <span class="ne">FloatingPointError</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

    <span class="k">return</span> <span class="n">intensive_phiq</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">d</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="spotoptim.sampling.mm.mmphi_intensive_update" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mmphi_intensive_update</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">new_point</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">normalize_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#spotoptim.sampling.mm.mmphi_intensive_update" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Updates the Morris-Mitchell intensive criterion for n+1 points by adding a new point to the design.
This should be more efficient than recalculating the metric from scratch, because it only needs to
compute the distances between the new point and the existing points.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Existing sampling plan (shape: (n, d)).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>new_point</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New point to add (shape: (d,)).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>J</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Multiplicities of distances for the existing design.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>d</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unique distances for the existing design.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exponent used in the computation of the Morris-Mitchell metric. Defaults to 2.0.</p>
              </div>
            </td>
            <td>
                  <code>2.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Distance norm to use (e.g., p=1 for Manhattan, p=2 for Euclidean). Defaults to 2.0.</p>
              </div>
            </td>
            <td>
                  <code>2.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>normalize_flag</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, normalizes the X array and the new_point before computing distances. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>tuple[float, np.ndarray, np.ndarray]: Updated intensive_phiq, updated_J, updated_d.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotoptim.sampling.mm</span><span class="w"> </span><span class="kn">import</span> <span class="n">mmphi_intensive_update</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Existing design with 3 points in 2D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phiq</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">mmphi_intensive</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># New point to add</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_point</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Update the intensive criterion</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">updated_phiq</span><span class="p">,</span> <span class="n">updated_J</span><span class="p">,</span> <span class="n">updated_d</span> <span class="o">=</span> <span class="n">mmphi_intensive_update</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">new_point</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotoptim/sampling/mm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mmphi_intensive_update</span><span class="p">(</span>
    <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">new_point</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">J</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">d</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">q</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="n">normalize_flag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the Morris-Mitchell intensive criterion for n+1 points by adding a new point to the design.</span>
<span class="sd">    This should be more efficient than recalculating the metric from scratch, because it only needs to</span>
<span class="sd">    compute the distances between the new point and the existing points.</span>

<span class="sd">    Args:</span>
<span class="sd">        X (np.ndarray): Existing sampling plan (shape: (n, d)).</span>
<span class="sd">        new_point (np.ndarray): New point to add (shape: (d,)).</span>
<span class="sd">        J (np.ndarray): Multiplicities of distances for the existing design.</span>
<span class="sd">        d (np.ndarray): Unique distances for the existing design.</span>
<span class="sd">        q (float): Exponent used in the computation of the Morris-Mitchell metric. Defaults to 2.0.</span>
<span class="sd">        p (float): Distance norm to use (e.g., p=1 for Manhattan, p=2 for Euclidean). Defaults to 2.0.</span>
<span class="sd">        normalize_flag (bool): If True, normalizes the X array and the new_point before computing distances. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[float, np.ndarray, np.ndarray]: Updated intensive_phiq, updated_J, updated_d.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from spotoptim.sampling.mm import mmphi_intensive_update</span>
<span class="sd">        &gt;&gt;&gt; # Existing design with 3 points in 2D</span>
<span class="sd">        &gt;&gt;&gt; X = np.array([[0.0, 0.0], [0.5, 0.5], [1.0, 1.0]])</span>
<span class="sd">        &gt;&gt;&gt; phiq, J, d = mmphi_intensive(X, q=2, p=2)</span>
<span class="sd">        &gt;&gt;&gt; # New point to add</span>
<span class="sd">        &gt;&gt;&gt; new_point = np.array([0.1, 0.1])</span>
<span class="sd">        &gt;&gt;&gt; # Update the intensive criterion</span>
<span class="sd">        &gt;&gt;&gt; updated_phiq, updated_J, updated_d = mmphi_intensive_update(X, new_point, J, d, q=2, p=2)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n_points</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">n_points</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The existing design must contain at least one point.&quot;</span><span class="p">)</span>

    <span class="c1"># Normalize X and new_point to [0, 1] in each dimension if requested</span>
    <span class="k">if</span> <span class="n">normalize_flag</span><span class="p">:</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">normalize_X</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">new_point</span> <span class="o">=</span> <span class="p">(</span><span class="n">new_point</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="c1"># Compute distances between the new point and all existing points</span>
    <span class="n">new_distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">new_point</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">ord</span><span class="o">=</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_points</span><span class="p">)]</span>
    <span class="p">)</span>

    <span class="c1"># Combine old distances and new distances into a single list</span>
    <span class="n">all_distances</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">dist</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">J</span><span class="p">):</span>
        <span class="n">all_distances</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">dist</span><span class="p">]</span> <span class="o">*</span> <span class="n">count</span><span class="p">)</span>
    <span class="n">all_distances</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">new_distances</span><span class="p">)</span>

    <span class="c1"># Find unique distances and their counts</span>
    <span class="n">updated_d</span><span class="p">,</span> <span class="n">updated_J</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">all_distances</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Calculate the number of unique pairs of points</span>
    <span class="n">M</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_points</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">n_points</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="c1"># Compute the updated intensive_phiq</span>
    <span class="n">sum_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">updated_J</span> <span class="o">*</span> <span class="p">(</span><span class="n">updated_d</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="p">)))</span>
    <span class="n">intensive_phiq</span> <span class="o">=</span> <span class="p">(</span><span class="n">sum_term</span> <span class="o">/</span> <span class="n">M</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">q</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">intensive_phiq</span><span class="p">,</span> <span class="n">updated_J</span><span class="p">,</span> <span class="n">updated_d</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="spotoptim.sampling.mm.mmsort" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mmsort</span><span class="p">(</span><span class="n">X3D</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span></code>

<a href="#spotoptim.sampling.mm.mmsort" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Ranks multiple sampling plans stored in a 3D array according to the
Morris-Mitchell criterion, using a simple bubble sort.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X3D</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 3D NumPy array of shape (n, d, m), where m is the number of
sampling plans, and each plan is an (n, d) matrix of points.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The distance metric to use. p=1 for Manhattan (L1), p=2 for
Euclidean (L2). Defaults to 1.0.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray:
A 1D integer array of length m that holds the plan indices in
ascending order of space-filling quality. The first index in the
returned array corresponds to the most space-filling plan.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>Many thanks to the original author of this code, A Sobester, for providing the original Matlab code
under the GNU Licence. Original Matlab Code: Copyright 2007 A Sobester:
&ldquo;This program is free software: you can redistribute it and/or modify  it
under the terms of the GNU Lesser General Public License as published by
the Free Software Foundation, either version 3 of the License, or any
later version.
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
General Public License for more details.
You should have received a copy of the GNU General Public License and GNU
Lesser General Public License along with this program. If not, see
<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.&rdquo;</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotoptim.sampling.mm</span><span class="w"> </span><span class="kn">import</span> <span class="n">mmsort</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Suppose we have two 3-point sampling plans in 2D, stored in X3D:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span>
<span class="gp">... </span>               <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Stack them along the third dimension: shape will be (3, 2, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X3D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Sort them using the Morris-Mitchell criterion with p=2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ranking</span> <span class="o">=</span> <span class="n">mmsort</span><span class="p">(</span><span class="n">X3D</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ranking</span><span class="p">)</span>
<span class="go"># It might print [2 1] or [1 2], depending on which plan is more space-filling.</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotoptim/sampling/mm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mmsort</span><span class="p">(</span><span class="n">X3D</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ranks multiple sampling plans stored in a 3D array according to the</span>
<span class="sd">    Morris-Mitchell criterion, using a simple bubble sort.</span>

<span class="sd">    Args:</span>
<span class="sd">        X3D (np.ndarray):</span>
<span class="sd">            A 3D NumPy array of shape (n, d, m), where m is the number of</span>
<span class="sd">            sampling plans, and each plan is an (n, d) matrix of points.</span>
<span class="sd">        p (float, optional):</span>
<span class="sd">            The distance metric to use. p=1 for Manhattan (L1), p=2 for</span>
<span class="sd">            Euclidean (L2). Defaults to 1.0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray:</span>
<span class="sd">            A 1D integer array of length m that holds the plan indices in</span>
<span class="sd">            ascending order of space-filling quality. The first index in the</span>
<span class="sd">            returned array corresponds to the most space-filling plan.</span>

<span class="sd">    Notes:</span>
<span class="sd">        Many thanks to the original author of this code, A Sobester, for providing the original Matlab code</span>
<span class="sd">        under the GNU Licence. Original Matlab Code: Copyright 2007 A Sobester:</span>
<span class="sd">        &quot;This program is free software: you can redistribute it and/or modify  it</span>
<span class="sd">        under the terms of the GNU Lesser General Public License as published by</span>
<span class="sd">        the Free Software Foundation, either version 3 of the License, or any</span>
<span class="sd">        later version.</span>
<span class="sd">        This program is distributed in the hope that it will be useful, but</span>
<span class="sd">        WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">        MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser</span>
<span class="sd">        General Public License for more details.</span>
<span class="sd">        You should have received a copy of the GNU General Public License and GNU</span>
<span class="sd">        Lesser General Public License along with this program. If not, see</span>
<span class="sd">        &lt;http://www.gnu.org/licenses/&gt;.&quot;</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from spotoptim.sampling.mm import mmsort</span>
<span class="sd">        &gt;&gt;&gt; # Suppose we have two 3-point sampling plans in 2D, stored in X3D:</span>
<span class="sd">        &gt;&gt;&gt; X1 = np.array([[0.0, 0.0],</span>
<span class="sd">        ...                [0.5, 0.5],</span>
<span class="sd">        ...                [1.0, 1.0]])</span>
<span class="sd">        &gt;&gt;&gt; X2 = np.array([[0.2, 0.2],</span>
<span class="sd">        ...                [0.6, 0.4],</span>
<span class="sd">        ...                [0.9, 0.9]])</span>
<span class="sd">        &gt;&gt;&gt; # Stack them along the third dimension: shape will be (3, 2, 2)</span>
<span class="sd">        &gt;&gt;&gt; X3D = np.stack([X1, X2], axis=2)</span>
<span class="sd">        &gt;&gt;&gt; # Sort them using the Morris-Mitchell criterion with p=2</span>
<span class="sd">        &gt;&gt;&gt; ranking = mmsort(X3D, p=2.0)</span>
<span class="sd">        &gt;&gt;&gt; print(ranking)</span>
<span class="sd">        # It might print [2 1] or [1 2], depending on which plan is more space-filling.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Number of plans (m)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">X3D</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Create index array (1-based to match original MATLAB convention)</span>
    <span class="n">Index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">swap_flag</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">while</span> <span class="n">swap_flag</span><span class="p">:</span>
        <span class="n">swap_flag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Compare plan at Index[i] vs. Index[i+1] using mm()</span>
            <span class="c1"># Note: subtract 1 from each index to convert to 0-based array indexing</span>
            <span class="k">if</span> <span class="n">mm</span><span class="p">(</span><span class="n">X3D</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">Index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">X3D</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">Index</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="c1"># Swap indices if the second plan is more space-filling</span>
                <span class="n">Index</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Index</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Index</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">Index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">swap_flag</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">Index</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="spotoptim.sampling.mm.perturb" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">perturb</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">PertNum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

<a href="#spotoptim.sampling.mm.perturb" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Performs a specified number of random element swaps on a sampling plan.
If the plan is a Latin hypercube, the result remains a valid Latin hypercube.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 2D array (sampling plan) of shape (n, k), where each row is a point
and each column is a dimension.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>PertNum</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of element swaps (perturbations) to perform. Defaults to 1.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray:
The perturbed sampling plan, identical in shape to the input, with
one or more random column swaps executed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>Many thanks to the original author of this code, A Sobester, for providing the original Matlab code
under the GNU Licence. Original Matlab Code: Copyright 2007 A Sobester:
&ldquo;This program is free software: you can redistribute it and/or modify  it
under the terms of the GNU Lesser General Public License as published by
the Free Software Foundation, either version 3 of the License, or any
later version.
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
General Public License for more details.
You should have received a copy of the GNU General Public License and GNU
Lesser General Public License along with this program. If not, see
<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.&rdquo;</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotoptim.sampling.mm</span><span class="w"> </span><span class="kn">import</span> <span class="n">perturb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a simple 4x2 sampling plan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_original</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">... </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Perturb it once</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_perturbed</span> <span class="o">=</span> <span class="n">perturb</span><span class="p">(</span><span class="n">X_original</span><span class="p">,</span> <span class="n">PertNum</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">X_perturbed</span><span class="p">)</span>
<span class="go"># The output may differ due to random swaps, but each column is still a permutation of [1,2,3,4].</span>
<span class="go">    [[1 3]</span>
<span class="go">    [2 2]</span>
<span class="go">    [3 1]</span>
<span class="go">    [4 4]]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotoptim/sampling/mm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">perturb</span><span class="p">(</span><span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">PertNum</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs a specified number of random element swaps on a sampling plan.</span>
<span class="sd">    If the plan is a Latin hypercube, the result remains a valid Latin hypercube.</span>

<span class="sd">    Args:</span>
<span class="sd">        X (np.ndarray):</span>
<span class="sd">            A 2D array (sampling plan) of shape (n, k), where each row is a point</span>
<span class="sd">            and each column is a dimension.</span>
<span class="sd">        PertNum (int, optional):</span>
<span class="sd">            The number of element swaps (perturbations) to perform. Defaults to 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray:</span>
<span class="sd">            The perturbed sampling plan, identical in shape to the input, with</span>
<span class="sd">            one or more random column swaps executed.</span>

<span class="sd">    Notes:</span>
<span class="sd">        Many thanks to the original author of this code, A Sobester, for providing the original Matlab code</span>
<span class="sd">        under the GNU Licence. Original Matlab Code: Copyright 2007 A Sobester:</span>
<span class="sd">        &quot;This program is free software: you can redistribute it and/or modify  it</span>
<span class="sd">        under the terms of the GNU Lesser General Public License as published by</span>
<span class="sd">        the Free Software Foundation, either version 3 of the License, or any</span>
<span class="sd">        later version.</span>
<span class="sd">        This program is distributed in the hope that it will be useful, but</span>
<span class="sd">        WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">        MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser</span>
<span class="sd">        General Public License for more details.</span>
<span class="sd">        You should have received a copy of the GNU General Public License and GNU</span>
<span class="sd">        Lesser General Public License along with this program. If not, see</span>
<span class="sd">        &lt;http://www.gnu.org/licenses/&gt;.&quot;</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from spotoptim.sampling.mm import perturb</span>
<span class="sd">        &gt;&gt;&gt; # Create a simple 4x2 sampling plan</span>
<span class="sd">        &gt;&gt;&gt; X_original = np.array([</span>
<span class="sd">        ...     [1, 3],</span>
<span class="sd">        ...     [2, 4],</span>
<span class="sd">        ...     [3, 1],</span>
<span class="sd">        ...     [4, 2]</span>
<span class="sd">        ... ])</span>
<span class="sd">        &gt;&gt;&gt; # Perturb it once</span>
<span class="sd">        &gt;&gt;&gt; X_perturbed = perturb(X_original, PertNum=1)</span>
<span class="sd">        &gt;&gt;&gt; print(X_perturbed)</span>
<span class="sd">        # The output may differ due to random swaps, but each column is still a permutation of [1,2,3,4].</span>
<span class="sd">            [[1 3]</span>
<span class="sd">            [2 2]</span>
<span class="sd">            [3 1]</span>
<span class="sd">            [4 4]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get dimensions of the plan</span>
    <span class="n">n</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Latin hypercubes require at least 2 points and 2 dimensions&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">PertNum</span><span class="p">):</span>
        <span class="c1"># Pick a random column</span>
        <span class="n">col</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="n">k</span><span class="p">))</span>

        <span class="c1"># Pick two distinct row indices</span>
        <span class="n">el1</span><span class="p">,</span> <span class="n">el2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">el1</span> <span class="o">==</span> <span class="n">el2</span><span class="p">:</span>
            <span class="n">el1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="n">n</span><span class="p">))</span>
            <span class="n">el2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="n">n</span><span class="p">))</span>

        <span class="c1"># Swap the two selected elements in the chosen column</span>
        <span class="n">X</span><span class="p">[</span><span class="n">el1</span><span class="p">,</span> <span class="n">col</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">el2</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">el2</span><span class="p">,</span> <span class="n">col</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">el1</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">X</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="spotoptim.sampling.mm.phisort" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">phisort</span><span class="p">(</span><span class="n">X3D</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span></code>

<a href="#spotoptim.sampling.mm.phisort" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Ranks multiple sampling plans stored in a 3D array by the Morris-Mitchell
numerical quality metric (mmphi). Uses a simple bubble-sort:
sampling plans with smaller mmphi values are placed first in the index array.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X3D</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 3D array of shape (n, d, m), where m is the number of sampling plans.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exponent for the mmphi metric. Defaults to 2.0.</p>
              </div>
            </td>
            <td>
                  <code>2.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Distance norm for mmphi. p=1 is Manhattan; p=2 is Euclidean. Defaults to 1.0.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray:
A 1D integer array of length m, giving the plan indices in ascending
order of mmphi. The first index in the returned array corresponds
to the numerically lowest mmphi value.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>Many thanks to the original author of this code, A Sobester, for providing the original Matlab code
under the GNU Licence. Original Matlab Code: Copyright 2007 A Sobester:
&ldquo;This program is free software: you can redistribute it and/or modify  it
under the terms of the GNU Lesser General Public License as published by
the Free Software Foundation, either version 3 of the License, or any
later version.
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
General Public License for more details.
You should have received a copy of the GNU General Public License and GNU
Lesser General Public License along with this program. If not, see
<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.&rdquo;</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotoptim.sampling.mm import phisort</span>
<span class="go">    from spotoptim.sampling.mm import bestlh</span>
<span class="go">    X1 = bestlh(n=5, k=2, population=5, iterations=10)</span>
<span class="go">    X2 = bestlh(n=5, k=2, population=15, iterations=20)</span>
<span class="go">    X3 = bestlh(n=5, k=2, population=25, iterations=30)</span>
<span class="go">    # Map X1 and X2 so that X3D has the two sampling plans in X3D[:, :, 0] and X3D[:, :, 1]</span>
<span class="go">    X3D = np.array([X1, X2])</span>
<span class="go">    print(phisort(X3D))</span>
<span class="go">    X3D = np.array([X3, X2])</span>
<span class="go">    print(phisort(X3D))</span>
<span class="go">        [2 1]</span>
<span class="go">        [1 2]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotoptim/sampling/mm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">phisort</span><span class="p">(</span>
    <span class="n">X3D</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ranks multiple sampling plans stored in a 3D array by the Morris-Mitchell</span>
<span class="sd">    numerical quality metric (mmphi). Uses a simple bubble-sort:</span>
<span class="sd">    sampling plans with smaller mmphi values are placed first in the index array.</span>

<span class="sd">    Args:</span>
<span class="sd">        X3D (np.ndarray):</span>
<span class="sd">            A 3D array of shape (n, d, m), where m is the number of sampling plans.</span>
<span class="sd">        q (float, optional):</span>
<span class="sd">            Exponent for the mmphi metric. Defaults to 2.0.</span>
<span class="sd">        p (float, optional):</span>
<span class="sd">            Distance norm for mmphi. p=1 is Manhattan; p=2 is Euclidean. Defaults to 1.0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray:</span>
<span class="sd">            A 1D integer array of length m, giving the plan indices in ascending</span>
<span class="sd">            order of mmphi. The first index in the returned array corresponds</span>
<span class="sd">            to the numerically lowest mmphi value.</span>

<span class="sd">    Notes:</span>
<span class="sd">        Many thanks to the original author of this code, A Sobester, for providing the original Matlab code</span>
<span class="sd">        under the GNU Licence. Original Matlab Code: Copyright 2007 A Sobester:</span>
<span class="sd">        &quot;This program is free software: you can redistribute it and/or modify  it</span>
<span class="sd">        under the terms of the GNU Lesser General Public License as published by</span>
<span class="sd">        the Free Software Foundation, either version 3 of the License, or any</span>
<span class="sd">        later version.</span>
<span class="sd">        This program is distributed in the hope that it will be useful, but</span>
<span class="sd">        WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">        MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser</span>
<span class="sd">        General Public License for more details.</span>
<span class="sd">        You should have received a copy of the GNU General Public License and GNU</span>
<span class="sd">        Lesser General Public License along with this program. If not, see</span>
<span class="sd">        &lt;http://www.gnu.org/licenses/&gt;.&quot;</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotoptim.sampling.mm import phisort</span>
<span class="sd">            from spotoptim.sampling.mm import bestlh</span>
<span class="sd">            X1 = bestlh(n=5, k=2, population=5, iterations=10)</span>
<span class="sd">            X2 = bestlh(n=5, k=2, population=15, iterations=20)</span>
<span class="sd">            X3 = bestlh(n=5, k=2, population=25, iterations=30)</span>
<span class="sd">            # Map X1 and X2 so that X3D has the two sampling plans in X3D[:, :, 0] and X3D[:, :, 1]</span>
<span class="sd">            X3D = np.array([X1, X2])</span>
<span class="sd">            print(phisort(X3D))</span>
<span class="sd">            X3D = np.array([X3, X2])</span>
<span class="sd">            print(phisort(X3D))</span>
<span class="sd">                [2 1]</span>
<span class="sd">                [1 2]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Number of 2D sampling plans</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">X3D</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Create a 1-based index array</span>
    <span class="n">Index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Bubble-sort: plan with lower mmphi() climbs toward the front</span>
    <span class="n">swap_flag</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">while</span> <span class="n">swap_flag</span><span class="p">:</span>
        <span class="n">swap_flag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="c1"># Retrieve mmphi values for consecutive plans</span>
            <span class="n">val_i</span> <span class="o">=</span> <span class="n">mmphi</span><span class="p">(</span><span class="n">X3D</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">Index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
            <span class="n">val_j</span> <span class="o">=</span> <span class="n">mmphi</span><span class="p">(</span><span class="n">X3D</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">Index</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>

            <span class="c1"># Swap if the left plan&#39;s mmphi is larger (i.e. &#39;worse&#39;)</span>
            <span class="k">if</span> <span class="n">val_i</span> <span class="o">&gt;</span> <span class="n">val_j</span><span class="p">:</span>
                <span class="n">Index</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Index</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Index</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">Index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">swap_flag</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="n">Index</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="spotoptim.sampling.mm.plot_mmphi_vs_n_lhs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_mmphi_vs_n_lhs</span><span class="p">(</span><span class="n">k_dim</span><span class="p">,</span> <span class="n">seed</span><span class="p">,</span> <span class="n">n_min</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">n_step</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">q_phi</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">p_phi</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span></code>

<a href="#spotoptim.sampling.mm.plot_mmphi_vs_n_lhs" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Generates LHS designs for varying n, calculates mmphi and mmphi_intensive,
and plots them against the number of samples (n).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>k_dim</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of dimensions for the LHS design.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed for reproducibility.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_min</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum number of samples.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_max</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of samples.</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_step</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Step size for increasing n.</p>
              </div>
            </td>
            <td>
                  <code>5</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q_phi</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exponent q for the Morris-Mitchell criteria.</p>
              </div>
            </td>
            <td>
                  <code>2.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p_phi</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Distance norm p for the Morris-Mitchell criteria.</p>
              </div>
            </td>
            <td>
                  <code>2.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>None</code></td>            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Displays a plot of mmphi and mmphi_intensive vs. number of samples (n).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotoptim.sampling.mm</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_mmphi_vs_n_lhs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_mmphi_vs_n_lhs</span><span class="p">(</span><span class="n">k_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_min</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_max</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">n_step</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">q_phi</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">p_phi</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotoptim/sampling/mm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_mmphi_vs_n_lhs</span><span class="p">(</span>
    <span class="n">k_dim</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">n_min</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">n_max</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
    <span class="n">n_step</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
    <span class="n">q_phi</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="n">p_phi</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates LHS designs for varying n, calculates mmphi and mmphi_intensive,</span>
<span class="sd">    and plots them against the number of samples (n).</span>

<span class="sd">    Args:</span>
<span class="sd">        k_dim (int): Number of dimensions for the LHS design.</span>
<span class="sd">        seed (int): Random seed for reproducibility.</span>
<span class="sd">        n_min (int): Minimum number of samples.</span>
<span class="sd">        n_max (int): Maximum number of samples.</span>
<span class="sd">        n_step (int): Step size for increasing n.</span>
<span class="sd">        q_phi (float): Exponent q for the Morris-Mitchell criteria.</span>
<span class="sd">        p_phi (float): Distance norm p for the Morris-Mitchell criteria.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None: Displays a plot of mmphi and mmphi_intensive vs. number of samples (n).</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from spotoptim.sampling.mm import plot_mmphi_vs_n_lhs</span>
<span class="sd">        &gt;&gt;&gt; plot_mmphi_vs_n_lhs(k_dim=3, seed=42, n_min=10, n_max=50, n_step=5, q_phi=2.0, p_phi=2.0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n_values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_min</span><span class="p">,</span> <span class="n">n_max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_step</span><span class="p">))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">n_values</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: n_values list is empty. Check n_min, n_max, and n_step.&quot;</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">mmphi_results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">mmphi_intensive_results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">lhs_sampler</span> <span class="o">=</span> <span class="n">LatinHypercube</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="n">k_dim</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">n_points</span> <span class="ow">in</span> <span class="n">n_values</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">n_points</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># mmphi requires at least 2 points to calculate distances</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skipping n=</span><span class="si">{</span><span class="n">n_points</span><span class="si">}</span><span class="s2"> as it&#39;s less than 2.&quot;</span><span class="p">)</span>
            <span class="n">mmphi_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
            <span class="n">mmphi_intensive_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">X_design</span> <span class="o">=</span> <span class="n">lhs_sampler</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n_points</span><span class="p">)</span>
            <span class="n">phi</span> <span class="o">=</span> <span class="n">mmphi</span><span class="p">(</span><span class="n">X_design</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q_phi</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p_phi</span><span class="p">)</span>
            <span class="n">phi_intensive</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mmphi_intensive</span><span class="p">(</span><span class="n">X_design</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q_phi</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p_phi</span><span class="p">)</span>
            <span class="n">mmphi_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
            <span class="n">mmphi_intensive_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">phi_intensive</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error calculating for n=</span><span class="si">{</span><span class="n">n_points</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">mmphi_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
            <span class="n">mmphi_intensive_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;tab:red&quot;</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Samples (n)&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;mmphi (Phiq)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">n_values</span><span class="p">,</span>
        <span class="n">mmphi_results</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;mmphi (Phiq)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>  <span class="c1"># instantiate a second axes that shares the same x-axis</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;tab:blue&quot;</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span>
        <span class="s2">&quot;mmphi_intensive (PhiqI)&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span>
    <span class="p">)</span>  <span class="c1"># we already handled the x-label with ax1</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">n_values</span><span class="p">,</span>
        <span class="n">mmphi_intensive_results</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;mmphi_intensive (PhiqI)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># otherwise the right y-label is slightly clipped</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Morris-Mitchell Criteria vs. Number of Samples (n)</span><span class="se">\n</span><span class="s2">LHS (k=</span><span class="si">{</span><span class="n">k_dim</span><span class="si">}</span><span class="s2">, q=</span><span class="si">{</span><span class="n">q_phi</span><span class="si">}</span><span class="s2">, p=</span><span class="si">{</span><span class="n">p_phi</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="p">)</span>
    <span class="c1"># Add legends</span>
    <span class="n">lines</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
    <span class="n">lines2</span><span class="p">,</span> <span class="n">labels2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">lines</span> <span class="o">+</span> <span class="n">lines2</span><span class="p">,</span> <span class="n">labels</span> <span class="o">+</span> <span class="n">labels2</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="spotoptim.sampling.mm.plot_mmphi_vs_points" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">plot_mmphi_vs_points</span><span class="p">(</span><span class="n">X_base</span><span class="p">,</span> <span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">p_min</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">p_max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">p_step</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_repeats</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></code>

<a href="#spotoptim.sampling.mm.plot_mmphi_vs_points" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Plot the Morris-Mitchell criterion versus the number of added points.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X_base</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base design matrix</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_min</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lower bounds for variables</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_max</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upper bounds for variables</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p_min</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum number of points to add</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p_max</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of points to add</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p_step</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Step size for number of points</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_repeats</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of repetitions for each point count</p>
              </div>
            </td>
            <td>
                  <code>5</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>pd.DataFrame: Summary DataFrame with mean and std of mmphi for each number of added points.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotoptim.sampling.mm</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_mmphi_vs_points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define base design</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">X_base</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Define variable bounds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Plot mmphi vs number of added points</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df_summary</span> <span class="o">=</span> <span class="n">plot_mmphi_vs_points</span><span class="p">(</span><span class="n">X_base</span><span class="p">,</span> <span class="n">x_min</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">p_min</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">p_max</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">p_step</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_repeats</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotoptim/sampling/mm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_mmphi_vs_points</span><span class="p">(</span>
    <span class="n">X_base</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">x_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">x_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">p_min</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">p_max</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
    <span class="n">p_step</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">n_repeats</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the Morris-Mitchell criterion versus the number of added points.</span>

<span class="sd">    Args:</span>
<span class="sd">        X_base (np.ndarray): Base design matrix</span>
<span class="sd">        x_min (np.ndarray): Lower bounds for variables</span>
<span class="sd">        x_max (np.ndarray): Upper bounds for variables</span>
<span class="sd">        p_min (int): Minimum number of points to add</span>
<span class="sd">        p_max (int): Maximum number of points to add</span>
<span class="sd">        p_step (int): Step size for number of points</span>
<span class="sd">        n_repeats (int): Number of repetitions for each point count</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: Summary DataFrame with mean and std of mmphi for each number of added points.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from spotoptim.sampling.mm import plot_mmphi_vs_points</span>
<span class="sd">        &gt;&gt;&gt; # Define base design</span>
<span class="sd">        &gt;&gt;&gt; X_base = np.array([[0.1, 0.2], [0.4, 0.5], [0.7, 0.8]])</span>
<span class="sd">        &gt;&gt;&gt; # Define variable bounds</span>
<span class="sd">        &gt;&gt;&gt; x_min = np.array([0.0, 0.0])</span>
<span class="sd">        &gt;&gt;&gt; x_max = np.array([1.0, 1.0])</span>
<span class="sd">        &gt;&gt;&gt; # Plot mmphi vs number of added points</span>
<span class="sd">        &gt;&gt;&gt; df_summary = plot_mmphi_vs_points(X_base, x_min, x_max, p_min=10, p_max=50, p_step=10, n_repeats=3)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">X_base</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">p_values</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">p_min</span><span class="p">,</span> <span class="n">p_max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p_step</span><span class="p">)</span>

    <span class="c1"># Calculate base mmphi value</span>
    <span class="n">mmphi_base</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mmphi_intensive</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_base</span><span class="p">)</span>

    <span class="c1"># Store results</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># For each number of points</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_values</span><span class="p">:</span>
        <span class="c1"># Repeat multiple times to get average behavior</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_repeats</span><span class="p">):</span>
            <span class="c1"># Generate random points</span>
            <span class="n">x_random</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="n">x_min</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">x_max</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span>

            <span class="c1"># Append to base design</span>
            <span class="n">X_extended</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X_base</span><span class="p">,</span> <span class="n">x_random</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

            <span class="c1"># Calculate new mmphi value</span>
            <span class="n">mmphi_extended</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mmphi_intensive</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X_extended</span><span class="p">)</span>

            <span class="c1"># Store results</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;n_points&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">,</span> <span class="s2">&quot;mmphi&quot;</span><span class="p">:</span> <span class="n">mmphi_extended</span><span class="p">})</span>

    <span class="c1"># Convert results to DataFrame for easier plotting</span>
    <span class="n">df_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

    <span class="c1"># Calculate mean and std for each point count</span>
    <span class="n">df_summary</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">df_results</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;n_points&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s2">&quot;mmphi&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;std&quot;</span><span class="p">]})</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="p">)</span>

    <span class="c1"># Create the plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="c1"># Plot mean line with error bars</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
        <span class="n">df_summary</span><span class="p">[</span><span class="s2">&quot;n_points&quot;</span><span class="p">],</span>
        <span class="n">df_summary</span><span class="p">[</span><span class="s2">&quot;mmphi&quot;</span><span class="p">][</span><span class="s2">&quot;mean&quot;</span><span class="p">],</span>
        <span class="n">yerr</span><span class="o">=</span><span class="n">df_summary</span><span class="p">[</span><span class="s2">&quot;mmphi&quot;</span><span class="p">][</span><span class="s2">&quot;std&quot;</span><span class="p">],</span>
        <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;bo-&quot;</span><span class="p">,</span>
        <span class="n">capsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="n">capthick</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">elinewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Mean mmphi  std&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Add error bands (optional - can keep or remove depending on preference)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
        <span class="n">df_summary</span><span class="p">[</span><span class="s2">&quot;n_points&quot;</span><span class="p">],</span>
        <span class="n">df_summary</span><span class="p">[</span><span class="s2">&quot;mmphi&quot;</span><span class="p">][</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">df_summary</span><span class="p">[</span><span class="s2">&quot;mmphi&quot;</span><span class="p">][</span><span class="s2">&quot;std&quot;</span><span class="p">],</span>
        <span class="n">df_summary</span><span class="p">[</span><span class="s2">&quot;mmphi&quot;</span><span class="p">][</span><span class="s2">&quot;mean&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df_summary</span><span class="p">[</span><span class="s2">&quot;mmphi&quot;</span><span class="p">][</span><span class="s2">&quot;std&quot;</span><span class="p">],</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Add baseline</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span>
        <span class="n">y</span><span class="o">=</span><span class="n">mmphi_base</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Base design mmphi (</span><span class="si">{</span><span class="n">mmphi_base</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Customize plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Number of Added Points&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Morris-Mitchell Criterion&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Morris-Mitchell Criterion vs Number of Added Points&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="c1"># Show plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">df_summary</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="spotoptim.sampling.mm.propose_mmphi_intensive_minimizing_point" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">propose_mmphi_intensive_minimizing_point</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">n_candidates</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">normalize_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#spotoptim.sampling.mm.propose_mmphi_intensive_minimizing_point" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Propose a new point that, when added to X, minimizes the intensive Morris-Mitchell (mmphi_intensive) criterion.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Existing points, shape (n_points, n_dim).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_candidates</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of random candidates to sample.</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>q</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exponent for mmphi_intensive.</p>
              </div>
            </td>
            <td>
                  <code>2.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>p</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Distance norm for mmphi_intensive.</p>
              </div>
            </td>
            <td>
                  <code>2.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lower</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lower bounds for each dimension (default: 0).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>upper</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Upper bounds for each dimension (default: 1).</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>normalize_flag</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, normalizes the X array and candidate points before computing distances. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: Proposed new point, shape (1, n_dim).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="go">    from spotoptim.sampling.mm import propose_mmphi_intensive_minimizing_point</span>
<span class="go">    # Existing design with 3 points in 2D</span>
<span class="go">    X = np.array([[1.0, 0.0], [0.5, 0.5], [1.0, 1.0]])</span>
<span class="go">    # Propose a new point</span>
<span class="go">    new_point = propose_mmphi_intensive_minimizing_point(X, n_candidates=500, q=2, p=2, seed=42)</span>
<span class="go">    print(new_point)</span>
<span class="go">    # plot the existing points and the new proposed point</span>
<span class="go">    import matplotlib.pyplot as plt</span>
<span class="go">    plt.scatter(X[:, 0], X[:, 1], color=&#39;blue&#39;, label=&#39;Existing Points&#39;)</span>
<span class="go">    plt.scatter(new_point[0, 0], new_point[0, 1], color=&#39;red&#39;, label=&#39;Proposed Point&#39;)</span>
<span class="go">    plt.legend()</span>
<span class="go">    # add grid and labels</span>
<span class="go">    plt.grid()</span>
<span class="go">    plt.title(&#39;MM-PHI Proposed Point&#39;)</span>
<span class="go">    plt.xlabel(&#39;X1&#39;)</span>
<span class="go">    plt.ylabel(&#39;X2&#39;)</span>
<span class="go">    plt.show()</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotoptim/sampling/mm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">propose_mmphi_intensive_minimizing_point</span><span class="p">(</span>
    <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">n_candidates</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">q</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="n">p</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">lower</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">upper</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">normalize_flag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Propose a new point that, when added to X, minimizes the intensive Morris-Mitchell (mmphi_intensive) criterion.</span>

<span class="sd">    Args:</span>
<span class="sd">        X (np.ndarray): Existing points, shape (n_points, n_dim).</span>
<span class="sd">        n_candidates (int): Number of random candidates to sample.</span>
<span class="sd">        q (float): Exponent for mmphi_intensive.</span>
<span class="sd">        p (float): Distance norm for mmphi_intensive.</span>
<span class="sd">        seed (int, optional): Random seed.</span>
<span class="sd">        lower (np.ndarray, optional): Lower bounds for each dimension (default: 0).</span>
<span class="sd">        upper (np.ndarray, optional): Upper bounds for each dimension (default: 1).</span>
<span class="sd">        normalize_flag (bool): If True, normalizes the X array and candidate points before computing distances. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: Proposed new point, shape (1, n_dim).</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            from spotoptim.sampling.mm import propose_mmphi_intensive_minimizing_point</span>
<span class="sd">            # Existing design with 3 points in 2D</span>
<span class="sd">            X = np.array([[1.0, 0.0], [0.5, 0.5], [1.0, 1.0]])</span>
<span class="sd">            # Propose a new point</span>
<span class="sd">            new_point = propose_mmphi_intensive_minimizing_point(X, n_candidates=500, q=2, p=2, seed=42)</span>
<span class="sd">            print(new_point)</span>
<span class="sd">            # plot the existing points and the new proposed point</span>
<span class="sd">            import matplotlib.pyplot as plt</span>
<span class="sd">            plt.scatter(X[:, 0], X[:, 1], color=&#39;blue&#39;, label=&#39;Existing Points&#39;)</span>
<span class="sd">            plt.scatter(new_point[0, 0], new_point[0, 1], color=&#39;red&#39;, label=&#39;Proposed Point&#39;)</span>
<span class="sd">            plt.legend()</span>
<span class="sd">            # add grid and labels</span>
<span class="sd">            plt.grid()</span>
<span class="sd">            plt.title(&#39;MM-PHI Proposed Point&#39;)</span>
<span class="sd">            plt.xlabel(&#39;X1&#39;)</span>
<span class="sd">            plt.ylabel(&#39;X2&#39;)</span>
<span class="sd">            plt.show()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    <span class="n">n_dim</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">lower</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_dim</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">upper</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_dim</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">lower</span> <span class="o">&gt;=</span> <span class="n">upper</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Lower bounds must be less than upper bounds.&quot;</span><span class="p">)</span>
    <span class="c1"># Generate candidate points uniformly</span>
    <span class="n">candidates</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n_candidates</span><span class="p">,</span> <span class="n">n_dim</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">normalize_flag</span><span class="p">:</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">normalize_X</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="p">(</span><span class="n">candidates</span> <span class="o">-</span> <span class="n">lower</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">upper</span> <span class="o">-</span> <span class="n">lower</span><span class="p">)</span>
    <span class="n">best_phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
    <span class="n">best_point</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">cand</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
        <span class="n">X_aug</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">cand</span><span class="p">])</span>
        <span class="n">phi</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">mmphi_intensive</span><span class="p">(</span><span class="n">X_aug</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">phi</span> <span class="o">&lt;</span> <span class="n">best_phi</span><span class="p">:</span>
            <span class="n">best_phi</span> <span class="o">=</span> <span class="n">phi</span>
            <span class="n">best_point</span> <span class="o">=</span> <span class="n">cand</span>
    <span class="k">return</span> <span class="n">best_point</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="spotoptim.sampling.mm.subset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">subset</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">ns</span><span class="p">)</span></code>

<a href="#spotoptim.sampling.mm.subset" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Returns a space-filling subset of a given size from a sampling plan, along with
the remainder. It repeatedly attempts to substitute each point in the subset
with a point from the remainder if doing so improves the Morris-Mitchell metric.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>X</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A 2D array representing the original sampling plan, of shape (n, d).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ns</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The size of the desired subset.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>(<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple (Xs, Xr) where:
- Xs is the chosen subset of size ns, with space-filling properties.
- Xr is the remainder (X \ Xs).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>Many thanks to the original author of this code, A Sobester, for providing the original Matlab code
under the GNU Licence. Original Matlab Code: Copyright 2007 A Sobester:
&ldquo;This program is free software: you can redistribute it and/or modify  it
under the terms of the GNU Lesser General Public License as published by
the Free Software Foundation, either version 3 of the License, or any
later version.
This program is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser
General Public License for more details.
You should have received a copy of the GNU General Public License and GNU
Lesser General Public License along with this program. If not, see
<a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.&rdquo;</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">spotoptim.sampling.mm</span><span class="w"> </span><span class="kn">import</span> <span class="n">subset</span><span class="p">,</span> <span class="n">bestlh</span>
<span class="go">    X = bestlh(n=5, k=3, population=5, iterations=10)</span>
<span class="go">    Xs, Xr = subset(X, ns=2)</span>
<span class="go">    print(Xs)</span>
<span class="go">    print(Xr)</span>
<span class="go">        [[0.25 0.   0.5 ]</span>
<span class="go">        [0.5  0.75 0.  ]]</span>
<span class="go">        [[1.   0.25 0.25]</span>
<span class="go">        [0.   1.   0.75]</span>
<span class="go">        [0.75 0.5  1.  ]]</span>
</code></pre></div>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>src/spotoptim/sampling/mm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">subset</span><span class="p">(</span><span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">ns</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a space-filling subset of a given size from a sampling plan, along with</span>
<span class="sd">    the remainder. It repeatedly attempts to substitute each point in the subset</span>
<span class="sd">    with a point from the remainder if doing so improves the Morris-Mitchell metric.</span>

<span class="sd">    Args:</span>
<span class="sd">        X (np.ndarray):</span>
<span class="sd">            A 2D array representing the original sampling plan, of shape (n, d).</span>
<span class="sd">        ns (int):</span>
<span class="sd">            The size of the desired subset.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (np.ndarray, np.ndarray):</span>
<span class="sd">            A tuple (Xs, Xr) where:</span>
<span class="sd">            - Xs is the chosen subset of size ns, with space-filling properties.</span>
<span class="sd">            - Xr is the remainder (X \\ Xs).</span>

<span class="sd">    Notes:</span>
<span class="sd">        Many thanks to the original author of this code, A Sobester, for providing the original Matlab code</span>
<span class="sd">        under the GNU Licence. Original Matlab Code: Copyright 2007 A Sobester:</span>
<span class="sd">        &quot;This program is free software: you can redistribute it and/or modify  it</span>
<span class="sd">        under the terms of the GNU Lesser General Public License as published by</span>
<span class="sd">        the Free Software Foundation, either version 3 of the License, or any</span>
<span class="sd">        later version.</span>
<span class="sd">        This program is distributed in the hope that it will be useful, but</span>
<span class="sd">        WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">        MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser</span>
<span class="sd">        General Public License for more details.</span>
<span class="sd">        You should have received a copy of the GNU General Public License and GNU</span>
<span class="sd">        Lesser General Public License along with this program. If not, see</span>
<span class="sd">        &lt;http://www.gnu.org/licenses/&gt;.&quot;</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from spotoptim.sampling.mm import subset, bestlh</span>
<span class="sd">            X = bestlh(n=5, k=3, population=5, iterations=10)</span>
<span class="sd">            Xs, Xr = subset(X, ns=2)</span>
<span class="sd">            print(Xs)</span>
<span class="sd">            print(Xr)</span>
<span class="sd">                [[0.25 0.   0.5 ]</span>
<span class="sd">                [0.5  0.75 0.  ]]</span>
<span class="sd">                [[1.   0.25 0.25]</span>
<span class="sd">                [0.   1.   0.75]</span>
<span class="sd">                [0.75 0.5  1.  ]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Number of total points</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Morris-Mitchell parameters</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">q</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="c1"># Create a random permutation of row indices</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">permutation</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="c1"># Initial subset and remainder</span>
    <span class="n">Xs</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">r</span><span class="p">[:</span><span class="n">ns</span><span class="p">],</span> <span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">Xr</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="n">ns</span><span class="p">:],</span> <span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Attempt to improve space-filling by swapping points</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ns</span><span class="p">):</span>
        <span class="n">orig_crit</span> <span class="o">=</span> <span class="n">mmphi</span><span class="p">(</span><span class="n">Xs</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
        <span class="n">orig_point</span> <span class="o">=</span> <span class="n">Xs</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Track best substitution index and metric</span>
        <span class="n">bestsub</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">bestsubcrit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

        <span class="c1"># Try replacing Xs[j] with each candidate in Xr</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">ns</span><span class="p">):</span>
            <span class="n">Xs</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Xr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
            <span class="n">crit</span> <span class="o">=</span> <span class="n">mmphi</span><span class="p">(</span><span class="n">Xs</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">crit</span> <span class="o">&lt;</span> <span class="n">bestsubcrit</span><span class="p">:</span>
                <span class="n">bestsubcrit</span> <span class="o">=</span> <span class="n">crit</span>
                <span class="n">bestsub</span> <span class="o">=</span> <span class="n">i</span>

        <span class="c1"># If a better subset is found, swap permanently</span>
        <span class="k">if</span> <span class="n">bestsubcrit</span> <span class="o">&lt;</span> <span class="n">orig_crit</span><span class="p">:</span>
            <span class="n">Xs</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Xr</span><span class="p">[</span><span class="n">bestsub</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">Xr</span><span class="p">[</span><span class="n">bestsub</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">orig_point</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Xs</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">orig_point</span>

    <span class="k">return</span> <span class="n">Xs</span><span class="p">,</span> <span class="n">Xr</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2004 - 2025
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/bartzbeielstein" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/thomas-bartz-beielstein-3157b541/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../..", "features": ["content.code.copy", "navigation.instant", "navigation.indexes", "navigation.path", "navigation.prune", "navigation.expand"], "search": "../../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>